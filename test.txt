

I see the issue! The problem is that your video (VLC) is playing on top of the black screen, but when the video finishes, there's a brief moment where the desktop shows before the loading page appears. Also, the video audio continues playing because VLC might not be closing properly.
Let's fix this with a better approach:Fixed Startup Script - Proper SequencingCode #!/bin/bash
#
# Chatty AI Startup Script - Proper Sequencing 
#

# Configuration
VIDEO_PATH="/home/nickspi5/Chatty_AI/Chatty_AI_starting.mp4"
LOADING_PAGE="/home/nickspi5/Chatty_AI/templates/chatty_loading.html"
BLACK_PAGE="/home/nickspi5/Chatty_AI/teThe key changes:

Black screen shows FIRST - before any video
Better VLC handling - added --intf dummy and timeout to prevent hanging
Kill VLC processes - ensures audio stops completely
Proper sequencing - each step waits for the previous to complete
Controlled timing - explicit sleep periods between transitions

Now update your startup script:

nano /home/nickspi5/Chatty_AI/chatty_ai_startup_final.sh

Copy the content from the artifact above.

#!/bin/bash
#
# Chatty AI Startup Script - Proper Sequencing
#

# Configuration
VIDEO_PATH="/home/nickspi5/Chatty_AI/Chatty_AI_starting.mp4"
LOADING_PAGE="/home/nickspi5/Chatty_AI/templates/chatty_loading.html"
BLACK_PAGE="/home/nickspi5/Chatty_AI/templates/black.html"
CHATTY_URL="http://localhost:5000"
LOG_FILE="/home/nickspi5/Chatty_AI/logs/startup.log"

# Create log directory
mkdir -p /home/nickspi5/Chatty_AI/logs

# Function to log messages
log_message() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a "$LOG_FILE"
}

# Start logging
log_message "========================================="
log_message "Chatty AI Startup Sequence Initiated"
log_message "========================================="

# Set display
export DISPLAY=:0
export XAUTHORITY=/home/nickspi5/.Xauthority

# Wait for desktop to be ready
log_message "Waiting for desktop..."
while ! pgrep -x "pcmanfm" > /dev/null; do
    sleep 1
done

# Hide desktop elements first
log_message "Hiding desktop elements..."
/home/nickspi5/Chatty_AI/hide_desktop.sh
sleep 0.5

# STEP 1: Show black screen FIRST
log_message "Displaying black screen..."
chromium-browser \
    --kiosk \
    --noerrdialogs \
    --disable-infobars \
    --start-fullscreen \
    --window-position=0,0 \
    --window-size=1920,1080 \
    "file://$BLACK_PAGE" 2>/dev/null &

BLACK_PID=$!
sleep 2  # Give black screen time to fully render

# STEP 2: Play video (this will appear ON TOP of black screen)
if [ -f "$VIDEO_PATH" ]; then
    log_message "Playing startup video..."
    # Use timeout to ensure video doesn't hang
    timeout 30 cvlc --fullscreen --play-and-exit --intf dummy "$VIDEO_PATH" 2>/dev/null
    log_message "Video playback complete"
else
    log_message "Video not found at $VIDEO_PATH"
    sleep 5  # Show black screen for 5 seconds if no video
fi

# Kill any remaining VLC processes to stop audio
pkill vlc 2>/dev/null
sleep 0.5

# Kill black screen
log_message "Closing black screen..."
kill $BLACK_PID 2>/dev/null
sleep 0.5

# STEP 3: Show loading screen immediately
log_message "Launching loading screen..."
chromium-browser \
    --kiosk \
    --noerrdialogs \
    --disable-infobars \
    --start-fullscreen \
    "file://$LOADING_PAGE" 2>/dev/null &

LOADING_PID=$!

# Wait for loading screen to complete (adjust time as needed)
log_message "Loading screen running..."
sleep 8  # Adjust this to match your loading screen duration

# Kill loading screen
kill $LOADING_PID 2>/dev/null
sleep 0.5

# STEP 4: Launch main Chatty AI interface
log_message "Launching Chatty AI interface..."
chromium-browser \
    --kiosk \
    --noerrdialogs \
    --disable-infobars \
    --start-fullscreen \
    "$CHATTY_URL" 2>/dev/null &

MAIN_PID=$!
log_message "Chatty AI interface launched successfully"
log_message "========================================="

# Keep the main interface running
wait $MAIN_PID

Then make sure it's executable:

chmod +x /home/nickspi5/Chatty_AI/chatty_ai_startup_final.sh

Test it:

# Test manually first
sudo ./chatty_ai_startup_final.sh

If the loading screen duration needs adjustment, change this line:

sleep 8  # Change this number to match your loading screen duration

This should give you the exact sequence you want:

✅ No desktop visible
✅ Black screen appears first
✅ Video plays completely with audio
✅ Loading screen shows
✅ Main UI appears

Reboot and test! Let me know if the sequencing is now correct.


