

# Find where libcamera tools are installed
echo "=== Searching for libcamera tools ==="
find /usr -name "libcamera-hello" 2>/dev/null
find /opt -name "libcamera-hello" 2>/dev/null
find /bin -name "libcamera-hello" 2>/dev/null
find /usr/local -name "libcamera-hello" 2>/dev/null

# Check if they're in common locations
ls -la /usr/bin/libcamera* 2>/dev/null || echo "Not in /usr/bin"
ls -la /opt/vc/bin/libcamera* 2>/dev/null || echo "Not in /opt/vc/bin"
ls -la /usr/local/bin/libcamera* 2>/dev/null || echo "Not in /usr/local/bin"

# Check what the libcamera-tools package actually installed
dpkg -L libcamera-tools | grep bin

# Check if there are alternative command names
which libcamera-hello 2>/dev/null || echo "libcamera-hello not in PATH"
which cam 2>/dev/null || echo "cam not in PATH"

# Show current PATH
echo "=== Current PATH ==="
echo $PATH

# Check if we need to source something
echo "=== Checking for setup scripts ==="
ls -la /opt/vc/bin/ 2>/dev/null || echo "No /opt/vc/bin"
ls -la /boot/config.txt | head -5






# Try installing legacy camera tools as backup
sudo apt install -y libraspberrypi-bin

# Check if legacy tools work
which raspistill
which raspivid

# Test legacy camera if available
if command -v raspistill &> /dev/null; then
    echo "Testing legacy raspistill..."
    raspistill -o legacy_test.jpg -t 2000 -v
else
    echo "Legacy tools not available"
fi

# Alternative: Try cam utility (part of libcamera)
if command -v cam &> /dev/null; then
    echo "Testing cam utility..."
    cam --list-cameras
else
    echo "cam utility not found"
fi

# Check if we need to enable legacy camera support
echo "=== Current boot config ==="
grep -E "(camera|gpu|legacy)" /boot/firmware/config.txt 2>/dev/null || \
grep -E "(camera|gpu|legacy)" /boot/config.txt 2>/dev/null || \
echo "Could not read boot config"

# Add legacy camera support if needed
echo "=== Checking if we need legacy camera support ==="
if ! grep -q "start_x=1" /boot/firmware/config.txt 2>/dev/null && ! grep -q "start_x=1" /boot/config.txt 2>/dev/null; then
    echo "Legacy camera support not enabled - this might be needed"
    echo "You can enable it with: sudo raspi-config -> Advanced Options -> Legacy Camera"
fi




