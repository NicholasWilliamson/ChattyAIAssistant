
Thank you, Claude,

I ran: nickspi5@raspberrypi:~ $ sed -n '135,145p' /home/nickspi5/Chatty_AI/chatty_ai_startup.sh
kill $LOADING_PID 2>/dev/null
sleep 0.5

STEP 4: Wait for service to be ready, then launch main Chatty AI interface
log_message "Waiting for Chatty AI service to be ready..."

MAX_WAIT=60
WAITED=0

while [ $WAITED -lt $MAX_WAIT ]; do
    if curl -s http://localhost:5000 > /dev/null 2>&1; then
nickspi5@raspberrypi:~ $ cat /home/nickspi5/Chatty_AI/chatty_ai_startup.sh
#!/bin/bash
#
export GNOME_KEYRING_CONTROL=""
export SSH_AUTH_SOCK=""
# Chatty AI Startup Script
#

# Configuration
VIDEO_PATH="/home/nickspi5/Chatty_AI/Chatty_AI_starting.mp4"
LOADING_PAGE="/home/nickspi5/Chatty_AI/templates/chatty_loading.html"
BLACK_PAGE="/home/nickspi5/Chatty_AI/templates/black.html"
CHATTY_URL="http://localhost:5000"
LOG_FILE="/home/nickspi5/Chatty_AI/logs/startup.log"

# Create log directory
mkdir -p /home/nickspi5/Chatty_AI/logs

# Function to log messages
log_message() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a "$LOG_FILE"
}

# Start logging
log_message "========================================="
log_message "Chatty AI Startup Sequence Initiated"
log_message "========================================="

# Set display
export DISPLAY=:0
export XAUTHORITY=/home/nickspi5/.Xauthority

# Wait for X server to be ready
log_message "Waiting for X server..."
while ! xset q &>/dev/null; do
    sleep 0.5
done

# Hide desktop elements
log_message "Hiding desktop elements..."
pkill lxpanel 2>/dev/null
pkill pcmanfm 2>/dev/null
sleep 0.2

# STEP 1: Show black screen
log_message "Displaying black screen..."
chromium --password-store=basic \
    --kiosk \
    --noerrdialogs \
    --disable-infobars \
    --disable-session-crashed-bubble \
    --disable-restore-session-state \
    --disable-web-security \
    --start-fullscreen \
    --disable-features=TranslateUI \
    --disable-sync \
    --no-first-run \
    --disable-popup-blocking \
    --window-position=0,0 \
    --window-size=1920,1080 \
    "file://$BLACK_PAGE" 2>/dev/null &

BLACK_PID=$!
sleep 2  # Wait for black screen to render

# Ensure desktop is completely hidden
pcmanfm --desktop-off 2>/dev/null

# STEP 2: CLOSE black screen, THEN play video (so video replaces black screen)
log_message "Closing black screen before video..."
kill $BLACK_PID 2>/dev/null
sleep 0.5

if [ -f "$VIDEO_PATH" ]; then
    log_message "Playing startup video..."
    
    # Video is 15.02 seconds, so we know exact duration
    log_message "Video duration: 15 seconds"
    
    # Play video with optimal settings
    cvlc \
        --fullscreen \
        --no-video-title-show \
        --no-osd \
        --quiet \
        --intf dummy \
        --play-and-exit \
        "$VIDEO_PATH" 2>/dev/null &
    
    VLC_PID=$!
    
    # Wait for exact video duration (15 seconds + 1 second buffer)
    sleep 16
    
    # Force kill VLC if still running
    if ps -p $VLC_PID > /dev/null; then
        kill $VLC_PID 2>/dev/null
        sleep 1
    fi
    
    log_message "Video playback complete"
else
    log_message "Video not found at $VIDEO_PATH"
    sleep 15  # Show black screen for 15 seconds if no video
fi

# Kill any remaining VLC processes
pkill vlc 2>/dev/null
pkill cvlc 2>/dev/null
sleep 1

# STEP 3: Show loading screen for FULL 74 seconds
log_message "Launching loading screen for 74 seconds ..."
chromium --password-store=basic \
    --kiosk \
    --noerrdialogs \
    --disable-infobars \
    --disable-session-crashed-bubble \
    --disable-restore-session-state \
    --disable-web-security \
    --start-fullscreen \
    --disable-features=TranslateUI \
    --disable-sync \
    --no-first-run \
    --disable-popup-blocking \
    "file://$LOADING_PAGE" 2>/dev/null &

LOADING_PID=$!

# Wait for FULL loading screen duration (74 seconds)
log_message "Loading screen running for 74 seconds ..."
sleep 74

# Kill loading screen
log_message "Loading screen complete, closing..."
kill $LOADING_PID 2>/dev/null
sleep 0.5

STEP 4: Wait for service to be ready, then launch main Chatty AI interface
log_message "Waiting for Chatty AI service to be ready..."

MAX_WAIT=60
WAITED=0

while [ $WAITED -lt $MAX_WAIT ]; do
    if curl -s http://localhost:5000 > /dev/null 2>&1; then
        log_message "Chatty AI service is ready!"
        break
    fi
    sleep 2
    WAITED=$((WAITED + 2))
    
    if [ $((WAITED % 10)) -eq 0 ]; then
        log_message "Still waiting for service... ($WAITED seconds)"
    fi
done

if [ $WAITED -ge $MAX_WAIT ]; then
    log_message "WARNING: Service not ready after $MAX_WAIT seconds, launching anyway..."
fi

sleep 2  # Extra buffer

log_message "Launching Chatty AI interface..."
chromium --password-store=basic \
    --kiosk \
    --noerrdialogs \
    --disable-infobars \
    --disable-session-crashed-bubble \
    --disable-restore-session-state \
    --disable-web-security \
    --start-fullscreen \
    --disable-features=TranslateUI \
    --disable-sync \
    --no-first-run \
    --disable-popup-blocking \
    "$CHATTY_URL" 2>/dev/null &

MAIN_PID=$!
log_message "Chatty AI interface launched successfully (PID: $MAIN_PID)"
log_message "========================================="

# Keep the main interface running
wait $MAIN_PID
nickspi5@raspberrypi:~ $ journalctl -u chatty-ai.service --no-pager | tail -50
Dec 21 19:27:54 raspberrypi python[1087]: [07:27:46 PM] Loaded 37 face encodings
Dec 21 19:27:54 raspberrypi python[1087]: [07:27:46 PM] Telegram configuration loaded
Dec 21 19:27:54 raspberrypi python[1087]: [07:27:48 PM] Camera initialised successfully
Dec 21 19:27:54 raspberrypi python[1087]: Preloading AI models for optimal performance...
Dec 21 19:27:54 raspberrypi python[1087]: [07:27:48 PM] Loading Whisper model...
Dec 21 19:27:54 raspberrypi python[1087]: [07:27:52 PM] Whisper model loaded successfully
Dec 21 19:27:54 raspberrypi python[1087]: [07:27:52 PM] Loading LLaMA model...
Dec 21 19:27:54 raspberrypi python[1087]: [07:27:54 PM] LLaMA model loaded successfully
Dec 21 19:27:54 raspberrypi python[1087]: Chatty AI initialised successfully!
Dec 21 19:27:54 raspberrypi python[1087]: Chatty AI Web Server Starting...
Dec 21 19:27:54 raspberrypi python[1087]: ============================================================
Dec 21 19:27:54 raspberrypi python[1087]: â¨ Optimised for maximum speed and performance
Dec 21 19:27:54 raspberrypi python[1087]: ð Models preloaded for instant response
Dec 21 19:27:54 raspberrypi python[1087]: ð¯ Wake word detection optimized
Dec 21 19:27:54 raspberrypi python[1087]: ð± Web interface available
Dec 21 19:27:54 raspberrypi python[1087]: ============================================================
Dec 21 19:27:54 raspberrypi python[1087]:  * Serving Flask app 'chatty_ai'
Dec 21 19:27:54 raspberrypi python[1087]:  * Debug mode: off
Dec 21 19:27:54 raspberrypi python[1087]: WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
Dec 21 19:27:54 raspberrypi python[1087]:  * Running on all addresses (0.0.0.0)
Dec 21 19:27:54 raspberrypi python[1087]:  * Running on http://127.0.0.1:5000
Dec 21 19:27:54 raspberrypi python[1087]:  * Running on http://10.183.102.39:5000
Dec 21 19:27:54 raspberrypi python[1087]: Press CTRL+C to quit
Dec 21 19:29:10 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:10] "GET / HTTP/1.1" 200 -
Dec 21 19:29:10 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:10] "GET /static/Chatty_AI_logo.png HTTP/1.1" 304 -
Dec 21 19:29:10 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:10] "GET /video_feed HTTP/1.1" 200 -
Dec 21 19:29:10 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:10] "GET /captured_image HTTP/1.1" 200 -
Dec 21 19:29:10 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:10] "GET /static/diamond_coding_logo.png HTTP/1.1" 304 -
Dec 21 19:29:10 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:10] "GET /socket.io/?EIO=4&transport=polling&t=Pj01jvE HTTP/1.1" 200 -
Dec 21 19:29:10 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:10] "POST /socket.io/?EIO=4&transport=polling&t=Pj01jvw&sid=x7HCUXOqpB7rJYANAAAA HTTP/1.1" 200 -
Dec 21 19:29:10 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:10] "GET /socket.io/?EIO=4&transport=polling&t=Pj01jw0&sid=x7HCUXOqpB7rJYANAAAA HTTP/1.1" 200 -
Dec 21 19:29:10 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:10] "GET /socket.io/?EIO=4&transport=polling&t=Pj01jwS&sid=x7HCUXOqpB7rJYANAAAA HTTP/1.1" 200 -
Dec 21 19:29:10 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:10] "GET /socket.io/?EIO=4&transport=polling&t=Pj01jwy&sid=x7HCUXOqpB7rJYANAAAA HTTP/1.1" 200 -
Dec 21 19:29:10 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:10] "GET /favicon.ico HTTP/1.1" 404 -
Dec 21 19:29:12 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:12] "GET /health HTTP/1.1" 200 -
Dec 21 19:29:16 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:16] "GET /socket.io/?EIO=4&transport=websocket&sid=x7HCUXOqpB7rJYANAAAA HTTP/1.1" 200 -
Dec 21 19:29:16 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:16] "GET / HTTP/1.1" 200 -
Dec 21 19:29:19 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:19] "GET / HTTP/1.1" 200 -
Dec 21 19:29:19 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:19] "GET /static/Chatty_AI_logo.png HTTP/1.1" 304 -
Dec 21 19:29:19 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:19] "GET /video_feed HTTP/1.1" 200 -
Dec 21 19:29:19 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:19] "GET /captured_image HTTP/1.1" 200 -
Dec 21 19:29:19 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:19] "GET /static/diamond_coding_logo.png HTTP/1.1" 304 -
Dec 21 19:29:19 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:19] "GET /socket.io/?EIO=4&transport=polling&t=Pj01m24 HTTP/1.1" 200 -
Dec 21 19:29:19 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:19] "POST /socket.io/?EIO=4&transport=polling&t=Pj01m2t&sid=S6ApL9GxLMQM7gNWAAAC HTTP/1.1" 200 -
Dec 21 19:29:19 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:19] "GET /socket.io/?EIO=4&transport=polling&t=Pj01m2y&sid=S6ApL9GxLMQM7gNWAAAC HTTP/1.1" 200 -
Dec 21 19:29:19 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:19] "GET /socket.io/?EIO=4&transport=polling&t=Pj01m3R&sid=S6ApL9GxLMQM7gNWAAAC HTTP/1.1" 200 -
Dec 21 19:29:19 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:19] "GET /socket.io/?EIO=4&transport=polling&t=Pj01m3p&sid=S6ApL9GxLMQM7gNWAAAC HTTP/1.1" 200 -
Dec 21 19:29:19 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:19] "GET /favicon.ico HTTP/1.1" 404 -
Dec 21 19:29:21 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:29:21] "GET /health HTTP/1.1" 200 -
Dec 21 19:31:37 raspberrypi python[1087]: 127.0.0.1 - - [21/Dec/2025 19:31:37] "GET /socket.io/?EIO=4&transport=websocket&sid=S6ApL9GxLMQM7gNWAAAC HTTP/1.1" 200 -
nickspi5@raspberrypi:~ $ 

As the video is playing correctly already, I would prefer not to change to mpv and stick with VLC.












